pipeline {

agent { dockerfile true }
//agent {  docker { image 'debian:latest' }   }
//

stages {
//Начинаем шаги //   
   stage('Установка Kube cl') { 
          steps {
           sh '''curl -LO "https://dl.k8s.io/release/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/linux/amd64/kubectl" 
           chmod +x kubectl 
           export PATH="$PATH:$pwd"
          '''
    }
}
stage('Deployment') {
 steps{
   //sh './kubectl create -f deployment.yaml -n lesson-4 --validate=false'
   script {
           kubeconfig(caCertificate: 'LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURCakNDQWU2Z0F3SUJBZ0lCQVRBTkJna3Foa2lHOXcwQkFRc0ZBREFWTVJNd0VRWURWUVFERXdwdGFXNXAKYTNWaVpVTkJNQjRYRFRJMU1USXdOREV6TWpBeE9Wb1hEVE0xTVRJd016RXpNakF4T1Zvd0ZURVRNQkVHQTFVRQpBeE1LYldsdWFXdDFZbVZEUVRDQ0FTSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnRVBBRENDQVFvQ2dnRUJBTVNEClJYZy85QTN2dGcvNmZPM2FBMjNZdExQUUtTZnBDYUlvSlhYZEt2YzNNYk54eWFGOFhIOS8rWVVmbGo1SzlRbGEKWk5xeDBlQkdWOFUwbHlUdGtuN3p1RFpTaWRVbFRVTXZPTGFockJCazB6UDN3TDNuMzdlOGlTVEZjdEV1eWwzNgpBVzVoMjdRVXFqOWpJbjBzZTN5VDhnUTZzR1NNLzZSbWFQZGRtTld5aUtoYzVvR1BXQnA4M2xuanZCam8xU2hzCjI4c1RLMStFcnRpU0tKVXVxc096ekRLV1ppMUxYU3FpZmFDSG5JMklzUkRyYmpJa3FXWVJobW5qVWNiQ3M1TGEKZ3BmdDhRbVowK3NZQXVDQkgyekhYa1J6S3dMOHB3TE1kbWZhODZxMG9ZekNvWUpRZ1BGczdFUUx4QUt4S1FiNApaSnJhL1oveEZORzlrNnF3bWM4Q0F3RUFBYU5oTUY4d0RnWURWUjBQQVFIL0JBUURBZ0trTUIwR0ExVWRKUVFXCk1CUUdDQ3NHQVFVRkJ3TUNCZ2dyQmdFRkJRY0RBVEFQQmdOVkhSTUJBZjhFQlRBREFRSC9NQjBHQTFVZERnUVcKQkJRNUg3MldFTzBFZVNRc1hWb1pNOWVhRDF3MHZ6QU5CZ2txaGtpRzl3MEJBUXNGQUFPQ0FRRUFPdTRyUXI1UgpyQjg4a1hyYlNwT2lpTzFWSHI3SlUrZVpvSEhTbkRKblM3a2F5WkRYVkpOaEtLTHdXd0JweE1kRXRiWkM1czd5Ck1CTGMzTktheEtJLzE5N2lYdzdaOWZiZHVNNlk1ZGZjdVV2c3pWUTVENm9qSC9Hb1FYalJMVmdxd1ZjVGlFUUUKNUpFU3NITWlUUzNNM3ZmUnhsREdlS2ltazJSa0ovN0FuM0FMOFJRUk9vSUFwNnAxcFlWcWJCWHQzREtVMWJSRAoxOWhpdXY5d0NaOThmOVNBWDJXYkFOcGpwSFRZOTBsbmlDZ2Y3b3BwcUhOekRBWm0wYVYrdHluTUN1VW1FR2dNCjdSRmgxdXJDOE8vL3I1Z3pwWG01RmN1dTBDVDE5ZlFGWklsWTNWcXFnOVMzemhlUTl3a1Y5R0tCbkZ0eWtDYzEKSUdsTDZyeXVWeWZxNFE9PQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==', credentialsId: 'kubeconfig', serverUrl: 'https://192.168.49.2:8443') {
           // Run kubectl
           sh 'kubectl create -f deployment.yaml'
           }
        }
      }
    }   
      //--||    ||--//
stage('Сетевые настройки ') {
     steps {
     sh 'ip a'
     }
}
stage('Какая ОС ') {
    steps {
     sh 'uname -a'    
     }
   }     
}
//
}