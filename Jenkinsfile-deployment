pipeline {
		agent { dockerfile true }
		environment {
			// The MY_KUBECONFIG environment variable will be assigned the value of a temporary file.
			// For example:
			//   /home/user/.jenkins/workspace/cred_test@tmp/secretFiles/546a5cf3-9b56-4165-a0fd-19e2afe6b31f/kubeconfig.txt
        MY_KUBECONFIG = credentials('111')
    }
	stages {
	//Начинаем шаги //	
		stage('Установка Kube ctl') {	
			steps {
				sh '	curl -LO "https://dl.k8s.io/release/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/linux/amd64/kubectl" '
			}
		}
		//--||    ||--//
	stage('kubernetes yaml Deployment') {
		agent {
			kubernetes {
				yaml '''
				apiVersion: v1
				kind: Deployment
				spec:
				replicas: 2
				spec:
				containers:
				- name: debian
				image: debian:latest
				'''
		}
	}
}

	post {
		success {
			echo 'Build&Deploy completed succesfully!'
		}
		failure {
			echo 'Build&Deploy failed. Check logs.'
		}
	}
}